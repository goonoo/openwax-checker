<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>웹 접근성 자동점검 보고서</title>
  <style>
    @page {
      size: A4;
      margin: 2cm;
    }
    
    body {
      font-family: 'Malgun Gothic', '맑은 고딕', sans-serif;
      margin: 0;
      padding: 0;
      font-size: 12px;
      line-height: 1.4;
      color: #333;
    }
    
    .report-container {
      max-width: 800px;
      margin: 0 auto;
      background: white;
    }
    
    .header {
      text-align: center;
      margin-bottom: 20px;
      border-bottom: 2px solid #333;
      padding-bottom: 20px;
    }
    
    .title {
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 0;
    }
    
    .logos {
      display: flex;
      justify-content: flex-end;
      gap: 20px;
      margin-bottom: 20px;
    }
    
    .logo {
      font-size: 14px;
      font-weight: bold;
      padding: 8px 12px;
      border: 1px solid #333;
      border-radius: 4px;
    }
    
    .info-section {
      margin-bottom: 30px;
    }
    
    .info-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 20px;
    }
    
    .info-item {
      display: flex;
      align-items: center;
    }
    
    .info-label {
      font-weight: bold;
      min-width: 120px;
    }
    
    .info-value {
      flex: 1;
    }
    
    .results-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 30px;
    }
    
    .results-table th,
    .results-table td {
      border: 1px solid #333;
      padding: 5px;
      text-align: center;
      vertical-align: middle;
    }
    
    .results-table th {
      background-color: #f5f5f5;
      font-weight: bold;
    }
    
    .category-header td {
      background-color: #e9e9e9;
      font-weight: bold;
      text-align: left;
    }
    
    .results-table td.sub-item {
      text-align: left;
      padding-left: 20px;
    }
    
    .notes-section {
      margin-top: 40px;
      padding: 20px;
      background-color: #f9f9f9;
      border: 1px solid #ddd;
    }
    
    .notes-title {
      font-weight: bold;
      margin-bottom: 15px;
    }
    
    .notes-list {
      margin: 0;
      padding-left: 20px;
    }
    
    .notes-list li {
      margin-bottom: 8px;
    }
    
    .print-button {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 10px 20px;
      background: #007bff;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
    }
    
    .print-button:hover {
      background: #0056b3;
    }
    
    @media print {
      .print-button {
        display: none;
      }
      
      body {
        font-size: 10px;
      }
      
      .title {
        font-size: 20px;
      }
    }
  </style>
</head>
<body>
  <button class="print-button" onclick="window.print()">인쇄</button>
  
  <div class="report-container">
    <!-- 헤더 -->
    <div class="header">
      <div class="title">웹 접근성 자동점검 보고서</div>
    </div>
    
    <!-- 기본 정보 -->
    <div class="info-section">
      <div class="info-grid">
        <div class="info-item">
          <span class="info-label">웹사이트:</span>
          <span class="info-value"><%= url %></span>
        </div>
        <div class="info-item">
          <span class="info-label">평가 기준:</span>
          <span class="info-value">한국형 웹 콘텐츠 접근성 지침 2.2</span>
        </div>
        <div class="info-item">
          <span class="info-label">수집 페이지:</span>
          <span class="info-value"><%= totalPages || 1 %> 페이지</span>
        </div>
        <div class="info-item">
          <span class="info-label">점검 일시:</span>
          <span class="info-value"><%= new Date().getFullYear() %>년 <%= new Date().getMonth() + 1 %>월 <%= new Date().getDate() %>일</span>
        </div>
      </div>
    </div>
    
    <!-- 자동점검 결과 -->
    <h3 style="margin-bottom: 15px;">자동점검 결과</h3>
    <table class="results-table">
      <thead>
        <tr>
          <th>평가 항목</th>
          <th>항목수</th>
          <th>오류수</th>
          <th>준수율</th>
        </tr>
      </thead>
      <tbody>
        <!-- 5.1.1 적절한 대체 텍스트 제공 -->
        <tr class="category-header">
          <td colspan="4">5.1.1 적절한 대체 텍스트 제공</td>
        </tr>
        <tr>
          <td class="sub-item">&lt;img&gt; 대체텍스트 없음</td>
          <td><%= images ? images.length : 0 %></td>
          <td><%= images ? images.filter(img => img.alt === null).length : 0 %></td>
          <td><%= images && images.length > 0 ? Math.round(((images.length - images.filter(img => img.alt === null).length) / images.length) * 100) : 100 %>%</td>
        </tr>
        <tr>
          <td class="sub-item">background-image 대체텍스트 없음</td>
          <td><%= bgImages ? bgImages.length : 0 %></td>
          <td><%= bgImages ? bgImages.filter(bg => !bg.alt || bg.alt === '').length : 0 %></td>
          <td><%= bgImages && bgImages.length > 0 ? Math.round(((bgImages.length - bgImages.filter(bg => !bg.alt || bg.alt === '').length) / bgImages.length) * 100) : 100 %>%</td>
        </tr>
        
        <!-- 5.3.1 표의 구성 -->
        <tr class="category-header">
          <td colspan="4">5.3.1 표의 구성</td>
        </tr>
        <tr>
          <td class="sub-item">표 구조 오류</td>
          <td><%= tables ? tables.length : 0 %></td>
          <td><%= tables ? tables.filter(table => table.valid !== 'pass').length : 0 %></td>
          <td><%= tables && tables.length > 0 ? Math.round((tables.filter(table => table.valid === 'pass').length / tables.length) * 100) : 100 %>%</td>
        </tr>
        
        <!-- 6.1.2 초점 이동과 표시 -->
        <tr class="category-header">
          <td colspan="4">6.1.2 초점 이동과 표시</td>
        </tr>
        <tr>
          <td class="sub-item">초점 표시 문제</td>
          <td><%= focus ? focus.length : 0 %></td>
          <td><%= focus ? focus.length : 0 %></td>
          <td><%= focus && focus.length > 0 ? '0%' : '100%' %></td>
        </tr>
        
        <!-- 6.4.1 반복 영역 건너뛰기 -->
        <tr class="category-header">
          <td colspan="4">6.4.1 반복 영역 건너뛰기</td>
        </tr>
        <tr>
          <td class="sub-item">건너뛰기 링크 연결 오류</td>
          <td><%= skipNavigations ? skipNavigations.length : 0 %></td>
          <td><%= skipNavigations ? skipNavigations.filter(skip => !skip.connected).length : 0 %></td>
          <td><%= skipNavigations && skipNavigations.length > 0 ? Math.round((skipNavigations.filter(skip => skip.connected).length / skipNavigations.length) * 100) : 100 %>%</td>
        </tr>
        
        <!-- 6.4.2 제목 제공 -->
        <tr class="category-header">
          <td colspan="4">6.4.2 제목 제공</td>
        </tr>
        <tr>
          <td class="sub-item">페이지 제목 없음</td>
          <td><%= pageTitle ? 1 : 0 %></td>
          <td><%= pageTitle && pageTitle.valid !== 'pass' ? 1 : 0 %></td>
          <td><%= pageTitle && pageTitle.valid === 'pass' ? '100%' : '0%' %></td>
        </tr>
        <tr>
          <td class="sub-item">&lt;iframe&gt; 제목 없음</td>
          <td><%= frames ? frames.length : 0 %></td>
          <td><%= frames ? frames.filter(frame => frame.valid !== 'pass').length : 0 %></td>
          <td><%= frames && frames.length > 0 ? Math.round((frames.filter(frame => frame.valid === 'pass').length / frames.length) * 100) : 100 %>%</td>
        </tr>
        <tr>
          <td class="sub-item">콘텐츠 블록 제목 없음</td>
          <td><%= headings ? headings.length : 0 %></td>
          <td><%= headings && headings.length === 0 ? 1 : 0 %></td>
          <td><%= headings && headings.length > 0 ? '100%' : '0%' %></td>
        </tr>
        
        <!-- 7.1.1 기본 언어 표시 -->
        <tr class="category-header">
          <td colspan="4">7.1.1 기본 언어 표시</td>
        </tr>
        <tr>
          <td class="sub-item">기본언어 미정의</td>
          <td><%= pageLang ? pageLang.length : 0 %></td>
          <td><%= pageLang ? pageLang.filter(lang => lang.valid !== 'pass').length : 0 %></td>
          <td><%= pageLang && pageLang.length > 0 ? Math.round((pageLang.filter(lang => lang.valid === 'pass').length / pageLang.length) * 100) : 100 %>%</td>
        </tr>
        
        <!-- 7.2.1 사용자 요구에 따른 실행 -->
        <tr class="category-header">
          <td colspan="4">7.2.1 사용자 요구에 따른 실행</td>
        </tr>
        <tr>
          <td class="sub-item">새창열림 사전공지 없음</td>
          <td><%= userRequest ? userRequest.length : 0 %></td>
          <td><%= userRequest ? userRequest.filter(req => req.valid !== 'pass').length : 0 %></td>
          <td><%= userRequest && userRequest.length > 0 ? Math.round((userRequest.filter(req => req.valid === 'pass').length / userRequest.length) * 100) : 100 %>%</td>
        </tr>
        
        <!-- 7.3.2 레이블 제공 -->
        <tr class="category-header">
          <td colspan="4">7.3.2 레이블 제공</td>
        </tr>
        <tr>
          <td class="sub-item">&lt;input&gt; 레이블 미제공</td>
          <td><%= inputLabels ? inputLabels.length : 0 %></td>
          <td><%= inputLabels ? inputLabels.filter(label => label.valid !== 'pass').length : 0 %></td>
          <td><%= inputLabels && inputLabels.length > 0 ? Math.round((inputLabels.filter(label => label.valid === 'pass').length / inputLabels.length) * 100) : 100 %>%</td>
        </tr>
        
        <!-- 8.2.1 웹 애플리케이션 접근성 준수 -->
        <tr class="category-header">
          <td colspan="4">8.2.1 웹 애플리케이션 접근성 준수</td>
        </tr>
        <tr>
          <td class="sub-item">WAI-ARIA 인터페이스 오류</td>
          <td><%= webApplication ? webApplication.length : 0 %></td>
          <td><%= webApplication ? webApplication.filter(app => app.valid !== 'pass').length : 0 %></td>
          <td><%= webApplication && webApplication.length > 0 ? Math.round((webApplication.filter(app => app.valid === 'pass').length / webApplication.length) * 100) : 100 %>%</td>
        </tr>
      </tbody>
    </table>
    
    <!-- 주의사항 -->
    <div class="notes-section">
      <div class="notes-title">※ 주의사항</div>
      <ol class="notes-list">
        <li>OpenWAX 자동 평가는 웹 접근성 표준 중 기계적으로 평가 가능한 항목에 대해서만 점검 결과를 제공합니다.</li>
        <li>웹 접근성 준수 여부는 OpenWAX 자동 평가만으로는 판단할 수 없으며, 웹 접근성 표준의 전체 지표에 따른 수동 평가를 통해 준수 여부를 확인해야 합니다.</li>
        <li>OpenWAX가 수집하는 웹 페이지의 수집 순서는 네트워크 속도에 따라 달라질 수 있습니다.</li>
        <li>평가 항목 "기본언어정의" 및 "마크업 문법"의 준수율은 문제가 없는 페이지 수를 전체 수집 페이지 수로 나누어 계산합니다.</li>
        <li>본 보고서는 한국형 웹 콘텐츠 접근성 지침 2.2 기준에 따라 작성되었습니다.</li>
      </ol>
    </div>
  </div>
</body>
</html> 